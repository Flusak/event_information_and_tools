# Windows Event ID
Здесь собранны базовые события Windows по их категориям, а также краткое описание событий и их основные поля.  




## Logon / Logoff
[4624](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4624) / 528 - Успешный вход в систему  
Основные поля:
- Имя учетной записи;
- Домен учетной записи;
- Имя компьютера;
- Тип входа:
  - 0 - система;
  - 2 - интерактивный;
  - 3 - сетевой;
  - 10 - удаленный вход и т.д.

[4625](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4625) / 529 - Неудачная попытка входа в систему по разным причинам (УЗ заблокирована, неверный пароль и т.д.)   
Основные поля:
- Имя учетной записи;
- Домен учетной записи;
- Имя компьютера;
- Тип входа:
  - 2 - интерактивный;
  - 3 - сетевой;
  - 10 - удаленный вход и т.д.

[4634](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4634) / 538 - Выход из системы  
Основные поля:
- Имя учетной записи;
- Домен учетной записи;
- Имя компьютера;
- Logon ID - уникальный id сессии, который совпадает с id от Event 4624.

[4647](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4647) / 551 - Пользователь инициировал выход  
Основные поля:
- Имя учетной записи;
- Домен учетной записи;
- Logon ID - уникальный id сессии, который совпадает с id от Event 4624.

Основное различие с "4634(S): Выход из системы" событие 4647 создается, когда процедура выхода была инициирована определенной учетной записью с помощью функции выхода, а событие 4634 показывает, что сеанс был завершен и больше не существует.

4647 является более типичным для типов входа Interactive(2) и RemoteInteractive(10), когда пользователь вышел из системы с помощью стандартных методов. Как правило, события 4647 и 4634 можно увидеть, когда процедура выхода инициирована пользователем.


## Kerberos

[4768](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4768) / 676 - Создается на контроллере домена, когда происходит запрос TGT  
Основные поля:
- Имя учетной записи клиента;
- Домен;
- Имя компьютера;
- Адрес и порт клиента;
- Код результата: 0x0 - нет ошибок, 0x1 - истек срок действия записи клиента, 0x6 - клиент не найден в базе данных и т.д.

[4769](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4769) / 673 - Создается на контроллере домена, когда происходит запрос TGS  
Основные поля:  
- Сведения об учетной записи:
  - Имя учетной записи клиента;
  - Домен;
  - Имя компьютера;
  - Адрес и порт клиента;
  - GUID входа - GUID, который совпадает с Event 4624.

- Сведения об сервисе:
  - Имя службы;
  - Идентификатор службы.

- Код результата:
  - 0x0 - нет ошибок;
  - 0x1 - истек срок действия записи клиента
  - 0x6 - клиент не найден в базе данных и т.д.

[4771](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4771) / 675  - Создается на контроллере домена, когда происходит запрос TGT и тикет не выдается.
Это событие не создается, если для учетной записи задан параметр "Не требовать предварительной проверки подлинности Kerberos".
Основные поля:
- Идентификатор безопасности клиента - по сути Domain\account_name (LOCAL\ya_kaka);
- Имя учетной записи;
- Адрес и порт клиента;
- Код ошибки.

Некоторые причины:
- Cрок действия пароля пользователя истек;
- Был указан неправильный пароль;
- Пользователя, который запрашивает TGT, не найден в БД.


## NTLM

[4776](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4776) / 680 (удачные), 681 (неудачные) - Создается, когда происходит аутентификация при помощи алгоритма NTLM. Содержит в себе удачные и неудачные события.  
Основные поля:
- Имя учетной записи;
- Имя компьютера;
- Код ошибки. Некоторые коды:
  - 0x0 - Без ошибок;
  - 0xC000006A - Вход в учетную запись с неправильным паролем;
  - 0xC0000070 - Вход учетной записи с несанкционированной рабочей станции.


## Взаимодействие с учетными записями

[4720](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4720) / 624 - Создается на любом хосте, когда создается новая учетная запись (УЗ)  
Основные поля:
- Сведения об учетной записи, которая создала УЗ:
  - Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka);
  - Имя учетной записи;
  - Домен;
  - Logon ID - уникальный id сессии, который совпадает с id от Event 4624.  

- Сведения о новой учетной записи:
  - Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka);
  - Имя учетной записи;
  - Домен.

- Атрибуты:
  - Имя в SAM;
  - Домашная директория;
  - Блокировка учетной записи и т.д.

[4740](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4740) / 644 - УЗ была заблокирована  
Основые поля:
- Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka);
- Имя учетной записи;
- Имя вызывающего компьютера - имя учетной записи компьютера, из которой была получена попытка входа и после которой целевая учетная запись была заблокирована.

[4738](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4738) / 642 - Создается на любом хосте, когда происходит изменение в учетной записи (изменение пароля, активация УЗ, имя УЗ в SAM и т.д.)  
Основные поля:  
- Сведения об учетной записи, которая изменила УЗ:
  - Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka);
  - Имя учетной записи;
  - Домен;
  - Logon ID - уникальный id сессии, который совпадает с id от Event 4624. 

- Сведения об измененной учетной записи:
  - Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka);
  - Имя учетной записи;
  - Домен;
  - Атрибуты, которые были изменены.  

4728 / 632 - участник был добавлен в глобальную группу с поддержкой безопасности  
Событие схоже по структуре с Event 4732, которое описано ниже.  

4756 / 660 - участник был добавлен в универсальную группу с поддержкой безопасности  
Событие схоже по структуре с Event 4732, которое описано ниже.  

[4732](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4732) / 636 - участник был добавлен в локальную группу с поддержкой безопасности  
Основные поля:  
- Сведения об учетной записи, которая добавляет УЗ в группу:
  - Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka);
  - Имя учетной записи;
  - Домен;
  - Logon ID - уникальный id сессии, который совпадает с id от Event 4624.  

- Сведения об учетной записи, которую добавляют в группу:
  - Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka);
  - Имя учетной записи - различающееся имя учетной записи, добавленной в группу. Например: "CN=Auditor,CN=Users,DC=contoso,DC=local".  

- Сведения о группе:
  - Идентификатор безопасности группы - по сути Domain\group_name (LOCAL\ya_kaka_group);
  - Имя группы;
  - Домен группы.

[Подробнее о группах с поддержкой безопасности.](https://learn.microsoft.com/ru-ru/windows-server/identity/ad-ds/manage/understand-security-groups)


## Системные события
[1102](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-1102) / 517 - журнал аудита был очищен
Основные поля:
- Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka);
- Имя учетной записи;
- Домен;
- Logon ID - уникальный id сессии, который совпадает с id от Event 4624.  


## Процессы
[4688](https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4688) / 592 - создан процесс
Основные поля:
- Сведения о создателе:
  - Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka) либо другие (System, BUILTIN\some);
  - Имя учетной записи;
  - Домен;
  - Logon ID - уникальный id сессии, который совпадает с id от Event 4624.

- Сведения о субъекте создателя:
  - Идентификатор безопасности - по сути Domain\account_name (LOCAL\ya_kaka);
  - Имя учетной записи;
  - Домен;
  - Logon ID - уникальный id сессии, который совпадает с id от Event 4624.

- Сведения о процессе:
  - PID - id процесса, представленный в шестнадцатеричной системе счисления;
  - Имя нового процесса - полный системный путь до файла;
  - Тип токена - обозначает привелегии, которые нужны для запуска процесса.
    - %%1936 - контроль учетных записей отключен либо пользователь имеет встроенную учетную запись администратора;
    - %%1937 - включен контроль учетных записей и пользователь запускает программу с помощью команды "Запуск от имени администратора";
    - %%1938 - включен контроль учетных записей, приложение не требует права администратора и пользователь не запускает программу с помощью команды "Запуск от имени администратора".
  - PID процесса родителя - также представлен в шестнадцатеричной системе счисления;
  - Имя процесса родителя;
  - Командная линия процесса - содержит имя исполняемого файла и аргументы, которые были переданы в него.
